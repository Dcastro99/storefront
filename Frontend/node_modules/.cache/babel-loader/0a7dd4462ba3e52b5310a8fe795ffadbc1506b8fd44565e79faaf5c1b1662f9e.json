{"ast":null,"code":"import { __assign, __rest } from \"tslib\";\n// Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n// SPDX-License-Identifier: Apache-2.0\nimport clsx from 'clsx';\nimport { useMergeRefs } from '../../hooks/use-merge-refs';\nimport React, { useEffect, useRef } from 'react';\nimport { getBaseProps } from '../../base-component';\nimport { fireNonCancelableEvent, fireKeyboardEvent } from '../../events';\nimport { findUpUntil } from '../../utils/dom';\nimport styles from './styles.css.js';\nvar BOTTOM_TRIGGER_OFFSET = 80;\nvar getItemIndex = function (containerRef, event) {\n  var target = findUpUntil(event.target, function (element) {\n    return element === containerRef.current || !!element.dataset.mouseTarget;\n  });\n  var mouseTarget = target === null || target === void 0 ? void 0 : target.dataset.mouseTarget;\n  return mouseTarget ? parseInt(mouseTarget) : -1;\n};\nvar OptionsList = function (_a, ref) {\n  var _b;\n  var open = _a.open,\n    children = _a.children,\n    _c = _a.nativeAttributes,\n    nativeAttributes = _c === void 0 ? {} : _c,\n    onKeyDown = _a.onKeyDown,\n    onBlur = _a.onBlur,\n    onFocus = _a.onFocus,\n    onLoadMore = _a.onLoadMore,\n    onMouseUp = _a.onMouseUp,\n    onMouseMove = _a.onMouseMove,\n    _d = _a.position,\n    position = _d === void 0 ? 'relative' : _d,\n    _e = _a.role,\n    role = _e === void 0 ? 'listbox' : _e,\n    _f = _a.decreaseTopMargin,\n    decreaseTopMargin = _f === void 0 ? false : _f,\n    ariaLabelledby = _a.ariaLabelledby,\n    restProps = __rest(_a, [\"open\", \"children\", \"nativeAttributes\", \"onKeyDown\", \"onBlur\", \"onFocus\", \"onLoadMore\", \"onMouseUp\", \"onMouseMove\", \"position\", \"role\", \"decreaseTopMargin\", \"ariaLabelledby\"]);\n  var baseProps = getBaseProps(restProps);\n  var menuRef = useRef(null);\n  var handleScroll = function () {\n    var scrollContainer = menuRef === null || menuRef === void 0 ? void 0 : menuRef.current;\n    if (scrollContainer) {\n      var bottomEdgePosition = scrollContainer.scrollTop + scrollContainer.clientHeight;\n      var remainingScrollHeight = scrollContainer.scrollHeight - bottomEdgePosition;\n      if (remainingScrollHeight < BOTTOM_TRIGGER_OFFSET) {\n        fireNonCancelableEvent(onLoadMore);\n      }\n    }\n  };\n  useEffect(function () {\n    if (!open) {\n      return;\n    }\n    handleScroll();\n  });\n  var className = clsx(styles['options-list'], (_b = {}, _b[styles['decrease-top-margin']] = decreaseTopMargin, _b));\n  var mergedRef = useMergeRefs(ref, menuRef);\n  return React.createElement(\"ul\", __assign({}, baseProps, nativeAttributes, {\n    className: className,\n    ref: mergedRef,\n    style: {\n      position: position\n    },\n    role: role,\n    onScroll: handleScroll,\n    onKeyDown: function (event) {\n      return onKeyDown && fireKeyboardEvent(onKeyDown, event);\n    },\n    onMouseMove: function (event) {\n      return onMouseMove === null || onMouseMove === void 0 ? void 0 : onMouseMove(getItemIndex(menuRef, event));\n    },\n    onMouseUp: function (event) {\n      return onMouseUp === null || onMouseUp === void 0 ? void 0 : onMouseUp(getItemIndex(menuRef, event));\n    },\n    onBlur: function (event) {\n      return fireNonCancelableEvent(onBlur, {\n        relatedTarget: event.relatedTarget\n      });\n    },\n    onFocus: function () {\n      return fireNonCancelableEvent(onFocus);\n    },\n    tabIndex: -1,\n    \"aria-labelledby\": ariaLabelledby\n  }), open && children);\n};\nexport default React.forwardRef(OptionsList);","map":{"version":3,"mappings":"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","names":["clsx","useMergeRefs","React","useEffect","useRef","getBaseProps","fireNonCancelableEvent","fireKeyboardEvent","findUpUntil","styles","BOTTOM_TRIGGER_OFFSET","getItemIndex","containerRef","event","target","current","element","dataset","mouseTarget","parseInt","OptionsList","_a","ref","children","_c","nativeAttributes","onKeyDown","onBlur","onFocus","onLoadMore","onMouseUp","onMouseMove","_d","position","_e","role","_f","decreaseTopMargin","ariaLabelledby","restProps","baseProps","menuRef","handleScroll","scrollContainer","bottomEdgePosition","scrollTop","clientHeight","remainingScrollHeight","scrollHeight","open","className","_b","mergedRef","style","onScroll","relatedTarget","tabIndex","forwardRef"],"sources":["/Users/dcastro/node_modules/src/internal/components/options-list/index.tsx"],"sourcesContent":["// Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n// SPDX-License-Identifier: Apache-2.0\nimport clsx from 'clsx';\nimport { useMergeRefs } from '../../hooks/use-merge-refs';\nimport React, { useEffect, useRef } from 'react';\nimport { BaseComponentProps, getBaseProps } from '../../base-component';\nimport {\n  fireNonCancelableEvent,\n  NonCancelableEventHandler,\n  CancelableEventHandler,\n  BaseKeyDetail,\n  fireKeyboardEvent,\n} from '../../events';\nimport { findUpUntil } from '../../utils/dom';\nimport styles from './styles.css.js';\n\nexport interface OptionsListProps extends BaseComponentProps {\n  open?: boolean;\n  /**\n   * Options list\n   */\n  children: React.ReactNode;\n  nativeAttributes?: Record<string, any>;\n  /**\n   * Called when more items need to be loaded.\n   */\n  onLoadMore?: NonCancelableEventHandler;\n  onKeyDown?: CancelableEventHandler<BaseKeyDetail>;\n  onBlur?: NonCancelableEventHandler<{ relatedTarget: Node | null }>;\n  onFocus?: NonCancelableEventHandler;\n  onMouseUp?: (itemIndex: number) => void;\n  onMouseMove?: (itemIndex: number) => void;\n  position?: React.CSSProperties['position'];\n  role?: 'listbox' | 'list' | 'menu';\n  ariaLabelledby?: string;\n  decreaseTopMargin?: boolean;\n}\n\nconst BOTTOM_TRIGGER_OFFSET = 80;\n\nconst getItemIndex = (containerRef: React.RefObject<HTMLElement>, event: React.MouseEvent) => {\n  const target = findUpUntil(\n    event.target as HTMLElement,\n    element => element === containerRef.current || !!element.dataset.mouseTarget\n  );\n  const mouseTarget = target?.dataset.mouseTarget;\n  return mouseTarget ? parseInt(mouseTarget) : -1;\n};\n\nconst OptionsList = (\n  {\n    open,\n    children,\n    nativeAttributes = {},\n    onKeyDown,\n    onBlur,\n    onFocus,\n    onLoadMore,\n    onMouseUp,\n    onMouseMove,\n    position = 'relative',\n    role = 'listbox',\n    decreaseTopMargin = false,\n    ariaLabelledby,\n    ...restProps\n  }: OptionsListProps,\n  ref: React.Ref<HTMLUListElement>\n) => {\n  const baseProps = getBaseProps(restProps);\n  const menuRef = useRef<HTMLUListElement>(null);\n\n  const handleScroll = () => {\n    const scrollContainer = menuRef?.current;\n    if (scrollContainer) {\n      const bottomEdgePosition = scrollContainer.scrollTop + scrollContainer.clientHeight;\n      const remainingScrollHeight = scrollContainer.scrollHeight - bottomEdgePosition;\n      if (remainingScrollHeight < BOTTOM_TRIGGER_OFFSET) {\n        fireNonCancelableEvent(onLoadMore);\n      }\n    }\n  };\n\n  useEffect(() => {\n    if (!open) {\n      return;\n    }\n    handleScroll();\n  });\n\n  const className = clsx(styles['options-list'], {\n    [styles['decrease-top-margin']]: decreaseTopMargin,\n  });\n\n  const mergedRef = useMergeRefs(ref, menuRef);\n\n  return (\n    <ul\n      {...baseProps}\n      {...nativeAttributes}\n      className={className}\n      ref={mergedRef}\n      style={{ position }}\n      role={role}\n      onScroll={handleScroll}\n      onKeyDown={event => onKeyDown && fireKeyboardEvent(onKeyDown, event)}\n      onMouseMove={event => onMouseMove?.(getItemIndex(menuRef, event))}\n      onMouseUp={event => onMouseUp?.(getItemIndex(menuRef, event))}\n      onBlur={event => fireNonCancelableEvent(onBlur, { relatedTarget: event.relatedTarget })}\n      onFocus={() => fireNonCancelableEvent(onFocus)}\n      tabIndex={-1}\n      aria-labelledby={ariaLabelledby}\n    >\n      {open && children}\n    </ul>\n  );\n};\n\nexport default React.forwardRef(OptionsList);\n"]},"metadata":{},"sourceType":"module","externalDependencies":[]}