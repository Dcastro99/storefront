{"ast":null,"code":"import { __spreadArray } from \"tslib\";\n// Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n// SPDX-License-Identifier: Apache-2.0\nimport { useState, useMemo, useCallback } from 'react';\nimport { indexIncludes, indexEquals } from './utils';\nimport createItemsTree from './create-items-tree';\nimport moveHighlightOneStep from './move-highlight';\nexport default function useHighlightedMenu(_a) {\n  var items = _a.items,\n    hasExpandableGroups = _a.hasExpandableGroups,\n    _b = _a.isInRestrictedView,\n    isInRestrictedView = _b === void 0 ? false : _b;\n  var _c = useState([]),\n    targetIndex = _c[0],\n    setTargetIndex = _c[1];\n  var _d = useState([]),\n    expandedIndex = _d[0],\n    setExpandedIndex = _d[1];\n  var _e = useState(true),\n    isUsingMouse = _e[0],\n    setIsUsingMouse = _e[1];\n  var _f = useMemo(function () {\n      return createItemsTree(items);\n    }, [items]),\n    getItem = _f.getItem,\n    getItemIndex = _f.getItemIndex,\n    getSequentialIndex = _f.getSequentialIndex,\n    getParentIndex = _f.getParentIndex;\n  var targetItem = useMemo(function () {\n    return getItem(targetIndex);\n  }, [targetIndex, getItem]);\n  var isHighlighted = useCallback(function (item) {\n    var index = getItemIndex(item);\n    return indexIncludes(index, targetIndex);\n  }, [targetIndex, getItemIndex]);\n  // check if keyboard focus is on the element\n  var isKeyboardHighlight = useCallback(function (item) {\n    var index = getItemIndex(item);\n    return !isUsingMouse && indexEquals(index, targetIndex);\n  }, [targetIndex, getItemIndex, isUsingMouse]);\n  var isExpanded = useCallback(function (group) {\n    var index = getItemIndex(group);\n    return indexIncludes(index, expandedIndex);\n  }, [expandedIndex, getItemIndex]);\n  var moveHighlight = useCallback(function (direction) {\n    var getNext = function (index) {\n      var nextIndex = getSequentialIndex(index, direction);\n      var item = getItem(nextIndex || [-1]);\n      if (!nextIndex || !item) {\n        return null;\n      }\n      var parentIndex = getParentIndex(item);\n      var parentItem = parentIndex && getItem(parentIndex);\n      return {\n        index: nextIndex,\n        item: item,\n        parent: parentItem || undefined\n      };\n    };\n    var nextIndex = moveHighlightOneStep({\n      startIndex: targetIndex,\n      expandedIndex: expandedIndex,\n      getNext: getNext,\n      hasExpandableGroups: hasExpandableGroups,\n      isInRestrictedView: isInRestrictedView\n    });\n    if (nextIndex) {\n      setTargetIndex(nextIndex);\n    }\n  }, [targetIndex, expandedIndex, getItem, getSequentialIndex, getParentIndex, hasExpandableGroups, isInRestrictedView]);\n  var highlightItem = useCallback(function (item) {\n    setTargetIndex(getItemIndex(item));\n  }, [getItemIndex]);\n  var expandGroup = useCallback(function (group) {\n    var groupIndex = group ? getItemIndex(group) : targetIndex;\n    var firstChildIndex = __spreadArray(__spreadArray([], groupIndex, true), [0], false);\n    // move to the first child item unless in restricted mode\n    setTargetIndex(isInRestrictedView ? groupIndex : firstChildIndex);\n    setExpandedIndex(groupIndex);\n  }, [targetIndex, getItemIndex, isInRestrictedView]);\n  var collapseGroup = useCallback(function () {\n    if (expandedIndex.length > 0) {\n      setTargetIndex(expandedIndex);\n      setExpandedIndex(expandedIndex.slice(0, -1));\n    }\n  }, [expandedIndex]);\n  var reset = useCallback(function () {\n    setTargetIndex([]);\n    setExpandedIndex([]);\n  }, []);\n  return {\n    targetItem: targetItem,\n    isHighlighted: isHighlighted,\n    isKeyboardHighlight: isKeyboardHighlight,\n    isExpanded: isExpanded,\n    moveHighlight: moveHighlight,\n    highlightItem: highlightItem,\n    expandGroup: expandGroup,\n    collapseGroup: collapseGroup,\n    reset: reset,\n    setIsUsingMouse: setIsUsingMouse\n  };\n}","map":{"version":3,"mappings":"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","names":["useState","useMemo","useCallback","indexIncludes","indexEquals","createItemsTree","moveHighlightOneStep","useHighlightedMenu","_a","items","hasExpandableGroups","_b","isInRestrictedView","targetIndex","setTargetIndex","expandedIndex","setExpandedIndex","isUsingMouse","setIsUsingMouse","getItem","getItemIndex","getSequentialIndex","getParentIndex","targetItem","isHighlighted","item","index","isKeyboardHighlight","isExpanded","group","moveHighlight","direction","getNext","nextIndex","parentIndex","parentItem","parent","undefined","startIndex","highlightItem","expandGroup","groupIndex","firstChildIndex","collapseGroup","length","slice","reset"],"sources":["/Users/dcastro/node_modules/src/button-dropdown/utils/use-highlighted-menu.ts"],"sourcesContent":["// Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n// SPDX-License-Identifier: Apache-2.0\nimport { useState, useMemo, useCallback } from 'react';\n\nimport { indexIncludes, indexEquals } from './utils';\nimport { ButtonDropdownProps, HighlightProps } from '../interfaces';\nimport createItemsTree, { TreeIndex } from './create-items-tree';\nimport moveHighlightOneStep from './move-highlight';\n\ninterface UseHighlightedMenuOptions {\n  items: ButtonDropdownProps.Items;\n  hasExpandableGroups: boolean;\n  isInRestrictedView?: boolean;\n}\n\ninterface UseHighlightedMenuApi extends HighlightProps {\n  moveHighlight: (direction: -1 | 1) => void;\n  expandGroup: (group?: ButtonDropdownProps.ItemGroup) => void;\n  collapseGroup: () => void;\n  reset: () => void;\n  setIsUsingMouse: (isUsingMouse: boolean) => void;\n}\n\nexport default function useHighlightedMenu({\n  items,\n  hasExpandableGroups,\n  isInRestrictedView = false,\n}: UseHighlightedMenuOptions): UseHighlightedMenuApi {\n  const [targetIndex, setTargetIndex] = useState<TreeIndex>([]);\n  const [expandedIndex, setExpandedIndex] = useState<TreeIndex>([]);\n  const [isUsingMouse, setIsUsingMouse] = useState<boolean>(true);\n\n  const { getItem, getItemIndex, getSequentialIndex, getParentIndex } = useMemo(() => createItemsTree(items), [items]);\n\n  const targetItem = useMemo(() => getItem(targetIndex), [targetIndex, getItem]);\n\n  const isHighlighted = useCallback(\n    (item: ButtonDropdownProps.ItemOrGroup) => {\n      const index = getItemIndex(item);\n      return indexIncludes(index, targetIndex);\n    },\n    [targetIndex, getItemIndex]\n  );\n\n  // check if keyboard focus is on the element\n  const isKeyboardHighlight = useCallback(\n    (item: ButtonDropdownProps.ItemOrGroup) => {\n      const index = getItemIndex(item);\n      return !isUsingMouse && indexEquals(index, targetIndex);\n    },\n    [targetIndex, getItemIndex, isUsingMouse]\n  );\n\n  const isExpanded = useCallback(\n    (group: ButtonDropdownProps.ItemGroup) => {\n      const index = getItemIndex(group);\n\n      return indexIncludes(index, expandedIndex);\n    },\n    [expandedIndex, getItemIndex]\n  );\n\n  const moveHighlight = useCallback(\n    (direction: -1 | 1) => {\n      const getNext = (index: TreeIndex) => {\n        const nextIndex = getSequentialIndex(index, direction);\n        const item = getItem(nextIndex || [-1]);\n\n        if (!nextIndex || !item) {\n          return null;\n        }\n\n        const parentIndex = getParentIndex(item);\n        const parentItem = parentIndex && getItem(parentIndex);\n\n        return { index: nextIndex, item, parent: parentItem || undefined };\n      };\n\n      const nextIndex = moveHighlightOneStep({\n        startIndex: targetIndex,\n        expandedIndex,\n        getNext,\n        hasExpandableGroups,\n        isInRestrictedView,\n      });\n\n      if (nextIndex) {\n        setTargetIndex(nextIndex);\n      }\n    },\n    [targetIndex, expandedIndex, getItem, getSequentialIndex, getParentIndex, hasExpandableGroups, isInRestrictedView]\n  );\n\n  const highlightItem = useCallback(\n    (item: ButtonDropdownProps.ItemOrGroup) => {\n      setTargetIndex(getItemIndex(item));\n    },\n    [getItemIndex]\n  );\n\n  const expandGroup = useCallback(\n    (group?: ButtonDropdownProps.ItemGroup) => {\n      const groupIndex = group ? getItemIndex(group) : targetIndex;\n      const firstChildIndex = [...groupIndex, 0];\n\n      // move to the first child item unless in restricted mode\n      setTargetIndex(isInRestrictedView ? groupIndex : firstChildIndex);\n      setExpandedIndex(groupIndex);\n    },\n    [targetIndex, getItemIndex, isInRestrictedView]\n  );\n\n  const collapseGroup = useCallback(() => {\n    if (expandedIndex.length > 0) {\n      setTargetIndex(expandedIndex);\n      setExpandedIndex(expandedIndex.slice(0, -1));\n    }\n  }, [expandedIndex]);\n\n  const reset = useCallback(() => {\n    setTargetIndex([]);\n    setExpandedIndex([]);\n  }, []);\n\n  return {\n    targetItem,\n    isHighlighted,\n    isKeyboardHighlight,\n    isExpanded,\n    moveHighlight,\n    highlightItem,\n    expandGroup,\n    collapseGroup,\n    reset,\n    setIsUsingMouse,\n  };\n}\n"]},"metadata":{},"sourceType":"module","externalDependencies":[]}