{"ast":null,"code":"// Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n// SPDX-License-Identifier: Apache-2.0\nimport { useEffect, useRef } from 'react';\nimport { useTelemetry } from '../use-telemetry';\nimport { PACKAGE_VERSION } from '../../environment';\nexport var COMPONENT_METADATA_KEY = '__awsuiMetadata__';\n/**\n * This hook is used for components which are exported to customers. The returned __internalRootRef needs to be\n * attached to the (internal) component's root DOM node. The hook takes care of attaching the metadata to this\n * root DOM node and emits the telemetry for this component.\n */\nexport default function useBaseComponent(componentName) {\n  var elementRef = useRef(null);\n  useTelemetry(componentName);\n  useComponentMetadata(componentName, elementRef);\n  return {\n    __internalRootRef: elementRef\n  };\n}\nfunction useComponentMetadata(componentName, elementRef) {\n  useEffect(function () {\n    if (elementRef.current && !Object.prototype.hasOwnProperty.call(elementRef.current, COMPONENT_METADATA_KEY)) {\n      var node = elementRef.current;\n      var metadata = {\n        name: componentName,\n        version: PACKAGE_VERSION\n      };\n      Object.freeze(metadata);\n      Object.defineProperty(node, COMPONENT_METADATA_KEY, {\n        value: metadata,\n        writable: false\n      });\n    }\n    // Some component refs change dynamically. E.g. The Modal component where\n    // the content gets rendered conditionally inside a Portal.\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [elementRef.current]);\n}","map":{"version":3,"mappings":"AAAA;AACA;AACA,SAA2BA,SAAS,EAAEC,MAAM,QAAQ,OAAO;AAC3D,SAASC,YAAY,QAAQ,kBAAkB;AAC/C,SAASC,eAAe,QAAQ,mBAAmB;AAEnD,OAAO,IAAMC,sBAAsB,GAAG,mBAAmB;AAMzD;;;;;AAKA,eAAc,SAAUC,gBAAgB,CAAUC,aAAqB;EACrE,IAAMC,UAAU,GAAGN,MAAM,CAAI,IAAI,CAAC;EAClCC,YAAY,CAACI,aAAa,CAAC;EAC3BE,oBAAoB,CAACF,aAAa,EAAEC,UAAU,CAAC;EAE/C,OAAO;IACLE,iBAAiB,EAAEF;GACpB;AACH;AAEA,SAASC,oBAAoB,CAACF,aAAqB,EAAEC,UAAiC;EAUpFP,SAAS,CAAC;IACR,IAAIO,UAAU,CAACG,OAAO,IAAI,CAACC,MAAM,CAACC,SAAS,CAACC,cAAc,CAACC,IAAI,CAACP,UAAU,CAACG,OAAO,EAAEN,sBAAsB,CAAC,EAAE;MAC3G,IAAMW,IAAI,GAAGR,UAAU,CAACG,OAA8B;MACtD,IAAMM,QAAQ,GAAG;QACfC,IAAI,EAAEX,aAAa;QACnBY,OAAO,EAAEf;OACV;MAEDQ,MAAM,CAACQ,MAAM,CAACH,QAAQ,CAAC;MACvBL,MAAM,CAACS,cAAc,CAACL,IAAI,EAAEX,sBAAsB,EAAE;QAClDiB,KAAK,EAAEL,QAAQ;QACfM,QAAQ,EAAE;OACX,CAAC;;IAEJ;IACA;IACA;EACF,CAAC,EAAE,CAACf,UAAU,CAACG,OAAO,CAAC,CAAC;AAC1B","names":["useEffect","useRef","useTelemetry","PACKAGE_VERSION","COMPONENT_METADATA_KEY","useBaseComponent","componentName","elementRef","useComponentMetadata","__internalRootRef","current","Object","prototype","hasOwnProperty","call","node","metadata","name","version","freeze","defineProperty","value","writable"],"sources":["/Users/dcastro/node_modules/src/internal/hooks/use-base-component/index.ts"],"sourcesContent":["// Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n// SPDX-License-Identifier: Apache-2.0\nimport { MutableRefObject, useEffect, useRef } from 'react';\nimport { useTelemetry } from '../use-telemetry';\nimport { PACKAGE_VERSION } from '../../environment';\n\nexport const COMPONENT_METADATA_KEY = '__awsuiMetadata__';\n\nexport interface InternalBaseComponentProps {\n  __internalRootRef?: MutableRefObject<any> | null;\n}\n\n/**\n * This hook is used for components which are exported to customers. The returned __internalRootRef needs to be\n * attached to the (internal) component's root DOM node. The hook takes care of attaching the metadata to this\n * root DOM node and emits the telemetry for this component.\n */\nexport default function useBaseComponent<T = any>(componentName: string) {\n  const elementRef = useRef<T>(null);\n  useTelemetry(componentName);\n  useComponentMetadata(componentName, elementRef);\n\n  return {\n    __internalRootRef: elementRef,\n  };\n}\n\nfunction useComponentMetadata(componentName: string, elementRef: MutableRefObject<any>) {\n  interface AwsUiMetadata {\n    name: string;\n    version: string;\n  }\n\n  interface HTMLMetadataElement extends HTMLElement {\n    [COMPONENT_METADATA_KEY]: AwsUiMetadata;\n  }\n\n  useEffect(() => {\n    if (elementRef.current && !Object.prototype.hasOwnProperty.call(elementRef.current, COMPONENT_METADATA_KEY)) {\n      const node = elementRef.current as HTMLMetadataElement;\n      const metadata = {\n        name: componentName,\n        version: PACKAGE_VERSION,\n      };\n\n      Object.freeze(metadata);\n      Object.defineProperty(node, COMPONENT_METADATA_KEY, {\n        value: metadata,\n        writable: false,\n      });\n    }\n    // Some component refs change dynamically. E.g. The Modal component where\n    // the content gets rendered conditionally inside a Portal.\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [elementRef.current]);\n}\n"]},"metadata":{},"sourceType":"module","externalDependencies":[]}